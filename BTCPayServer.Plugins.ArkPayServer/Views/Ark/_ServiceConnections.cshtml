@model BTCPayServer.Plugins.ArkPayServer.Models.StoreOverviewViewModel

<!-- Service Connections Card -->
<div class="card shadow-sm mb-4">
    <div class="card-header">
        <h5 class="mb-0">Service Connections</h5>
    </div>
    <div class="card-body">
        <div class="row g-3">
            <!-- Ark Operator -->
            <div class="col-md-6">
                <div class="d-flex align-items-start">
                    <div class="me-3">
                        @if (Model.ArkOperatorConnected)
                        {
                            <span class="badge rounded-circle bg-success p-2" style="width: 16px; height: 16px;" title="Connected" data-bs-toggle="tooltip"></span>
                        }
                        else
                        {
                            <span class="badge rounded-circle bg-danger p-2" style="width: 16px; height: 16px;" title="@(Model.ArkOperatorError ?? "Disconnected")" data-bs-toggle="tooltip"></span>
                        }
                    </div>
                    <div class="flex-fill">
                        <h6 class="mb-1">Ark Operator</h6>
                        @if (!string.IsNullOrEmpty(Model.ArkOperatorUrl))
                        {
                            <div class="text-muted small font-monospace text-break">@Model.ArkOperatorUrl</div>
                        }
                        @if (!Model.ArkOperatorConnected && !string.IsNullOrEmpty(Model.ArkOperatorError))
                        {
                            <div class="text-danger small mt-1">@Model.ArkOperatorError</div>
                        }
                        else if (Model.ArkOperatorConnected)
                        {
                            <div class="text-success small mt-1">Connected</div>
                        }
                    </div>
                </div>
            </div>

            <!-- Boltz -->
            <div class="col-md-6">
                <div class="d-flex align-items-start">
                    <div class="me-3">
                        @if (Model.BoltzConnected)
                        {
                            <span class="badge rounded-circle bg-success p-2" style="width: 16px; height: 16px;"
                                  title="Connected" data-bs-toggle="tooltip"></span>
                        }
                        else
                        {
                            <span class="badge rounded-circle bg-danger p-2" style="width: 16px; height: 16px;"
                                  title="@(Model.BoltzError ?? "Disconnected")" data-bs-toggle="tooltip"></span>
                        }
                    </div>
                    @if (!string.IsNullOrEmpty(Model.BoltzUrl))
                    {
                        <div class="flex-fill">
                            <h6 class="mb-1">Boltz Swap Service</h6>


                            <div class="text-muted small font-monospace text-break">@Model.BoltzUrl</div>

                            @if (!Model.BoltzConnected && !string.IsNullOrEmpty(Model.BoltzError))
                            {
                                <div class="text-danger small mt-1">@Model.BoltzError</div>
                            }
                            else if (Model.BoltzConnected)
                            {
                                <div class="text-success small mt-1">Connected</div>
                                @if (Model.BoltzReverseMinAmount.HasValue || Model.BoltzSubmarineMinAmount.HasValue)
                                {
                                    <div class="text-muted small mt-2">
                                        <strong>Lightning Limits:</strong>
                                        @if (Model.BoltzReverseMinAmount.HasValue && Model.BoltzReverseMaxAmount.HasValue)
                                        {
                                            <div class="mt-1">
                                                <span class="badge bg-secondary">Receive</span>
                                                @Model.BoltzReverseMinAmount.Value - @Model.BoltzReverseMaxAmount.Value sats
                                                @if (Model.BoltzReverseFeePercentage.HasValue || Model.BoltzReverseMinerFee.HasValue)
                                                {
                                                    <text>(</text>
                                                    @if (Model.BoltzReverseFeePercentage.HasValue)
                                                    {
                                                        <text>@((Model.BoltzReverseFeePercentage.Value * 100).ToString("0.##"))%</text>
                                                    }
                                                    @if (Model.BoltzReverseMinerFee.HasValue && Model.BoltzReverseMinerFee.Value > 0)
                                                    {
                                                        @if (Model.BoltzReverseFeePercentage.HasValue)
                                                        {
                                                            <text> + </text>
                                                        }
                                                        <text>@Model.BoltzReverseMinerFee.Value sats</text>
                                                    }
                                                    <text>)</text>
                                                }
                                            </div>
                                        }
                                        @if (Model.BoltzSubmarineMinAmount.HasValue && Model.BoltzSubmarineMaxAmount.HasValue)
                                        {
                                            <div class="mt-1">
                                                <span class="badge bg-secondary">Send</span>
                                                @Model.BoltzSubmarineMinAmount.Value - @Model.BoltzSubmarineMaxAmount.Value sats
                                                @if (Model.BoltzSubmarineFeePercentage.HasValue || Model.BoltzSubmarineMinerFee.HasValue)
                                                {
                                                    <text>(</text>
                                                    @if (Model.BoltzSubmarineFeePercentage.HasValue)
                                                    {
                                                        <text>@((Model.BoltzSubmarineFeePercentage.Value * 100).ToString("0.##"))%</text>
                                                    }
                                                    @if (Model.BoltzSubmarineMinerFee.HasValue && Model.BoltzSubmarineMinerFee.Value > 0)
                                                    {
                                                        @if (Model.BoltzSubmarineFeePercentage.HasValue)
                                                        {
                                                            <text> + </text>
                                                        }
                                                        <text>@Model.BoltzSubmarineMinerFee.Value sats</text>
                                                    }
                                                    <text>)</text>
                                                }
                                            </div>
                                        }
                                    </div>
                                }
                            }
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>
</div>
